<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>2XKO Overlay</title><style>html,body{width:100%;height:100%;margin:0;background:transparent;display:flex;justify-content:center;align-items:center;font-family:'Swiss 721',Arial,sans-serif}#app{display:flex}#stickWrapper{width:220px;height:220px;position:absolute;top:300px;left:60px;background:rgba(0,0,0,.8);border-radius:50%}#stickCanvas{width:100%;height:100%;display:block;background:transparent}#joystickHead{position:absolute;width:60px;height:60px;border-radius:50%;border:10px solid #000;transform:translate(-50%,-50%) scale(1);pointer-events:none;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:30px;transition:left .01s,top .01s,transform .1s;background:rgba(160,160,160,1)}#directionMarkers{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.marker{position:absolute;width:10px;height:10px;border-radius:50%;background:rgba(80,80,80,1);transform:translate(-50%,-50%);transition:all .1s}.marker.active{background:rgba(255,255,255,1);width:20px;height:20px}.buttons{position:relative;width:300px;height:300px}.btn{position:absolute;width:90px;height:90px;display:flex;align-items:center;justify-content:center;font-size:40px;text-transform:uppercase;transition:.05s;border-radius:50%;border:10px solid #000;box-shadow:0 2px 6px rgba(0,0,0,.25);font-family:'Swiss 721',Arial,sans-serif;filter:brightness(.6);overflow:hidden;text-align:center;white-space:nowrap}.btn.active{filter:brightness(1);transform:scale(1.05)}</style></head><body><div id="app"><div id="stickWrapper"><div id="directionMarkers"><div class="marker" id="marker0"></div><div class="marker" id="marker1"></div><div class="marker" id="marker2"></div><div class="marker" id="marker3"></div><div class="marker" id="marker4"></div><div class="marker" id="marker5"></div><div class="marker" id="marker6"></div><div class="marker" id="marker7"></div></div><canvas id="stickCanvas"></canvas><div id="joystickHead"></div></div><div class="controls"><div class="buttons" id="buttonGrid"></div></div></div><script>const c={deadzone:.1,trail:15,invertY:!1,buttonStyle:{borderColor:"#000",activeColor:"rgba(225,225,225,1)",defaultColor:"rgba(160,160,160,1)"},buttons:[{id:"A",top:240,left:280,label:"T",color:"rgba(200,200,200,1)"},{id:"B",top:120,left:280,label:"H",color:"rgba(200,200,200,1)"},{id:"X",top:120,left:40,label:"L",color:"rgba(200,200,200,1)"},{id:"Y",top:120,left:160,label:"M",color:"rgba(200,200,200,1)"},{id:"LB",top:240,left:400,label:"P",color:"rgba(200,200,200,1)"},{id:"RB",top:120,left:400,label:"D",color:"rgba(200,200,200,1)"},{id:"LT",top:240,left:40,label:"S1",color:"rgba(200,200,200,1)"},{id:"RT",top:240,left:160,label:"S2",color:"rgba(200,200,200,1)"},{id:"LS",top:0,left:-20,label:"L3",color:"rgba(120,120,120,1)"},{id:"RS",top:0,left:460,label:"R3",color:"rgba(120,120,120,1)"},{id:"View",top:0,left:100,label:"-",color:"rgba(120,120,120,1)"},{id:"Menu",top:0,left:340,label:"+",color:"rgba(120,120,120,1)"}],map:{A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,View:8,Menu:9,LS:10,RS:11},ignoredForJoystick:["View","Menu","LS","RS"],hiddenButtons:[]},b=document.getElementById("buttonGrid"),B={};c.buttons.forEach(d=>{if(c.hiddenButtons.includes(d.id))return;const e=document.createElement("div");e.className="btn",e.dataset.btn=d.id,e.textContent=d.label,e.style.top=d.top+"px",e.style.left=d.left+"px",e.style.background=d.color||c.buttonStyle.defaultColor,e.style.borderColor=c.buttonStyle.borderColor,b.appendChild(e),B[d.id]=e});function f(a){const e=a.clientWidth;a.style.fontSize="40px",requestAnimationFrame(()=>{let b=parseInt(window.getComputedStyle(a).fontSize);for(;a.scrollWidth>e&&b>8;)a.style.fontSize=--b+"px"})}Object.values(B).forEach(f);function g(a,b){a.textContent=b,a.style.fontSize="40px",f(a)}let G=null,H=document.getElementById("joystickHead"),I={};window.addEventListener("gamepadconnected",a=>G=a.gamepad.index),window.addEventListener("gamepaddisconnected",()=>G=null);function J(a){if(!a?.buttons)return H.style.transform="translate(-50%,-50%) scale(1)",H.textContent="",Object.values(B).forEach(a=>a.classList.remove("active")),void 0;for(const b in B){const c=d=>!!a.buttons[d]?.pressed,d=c(a=>c(a)),e=c(a=>c(a));const f=c(a=>c(a));const g=c(a=>c(a));const h=c(a=>c(a));const i=c(a=>c(a));const j=c(a=>c(a));}for(const b in B){const c=c.map[b];if(void 0===c)continue;const d=!!a.buttons[c]?.pressed;B[b].classList.toggle("active",d),I[b]=d?performance.now():I[b]||0}let K=null,L=-1;for(const b in I)B[b].classList.contains("active")&&!c.ignoredForJoystick.includes(b)&&I[b]>L&&(L=I[b],K=b);K?(H.style.transform="translate(-50%,-50%) scale(1.3)",H.textContent=B[K].textContent,H.style.background=B[K].style.background,H.style.color="#000"):(H.style.transform="translate(-50%,-50%) scale(1)",H.textContent="",H.style.background="rgba(215,215,215,1)")}function M(a,b,c){const d=Math.hypot(a,b);if(d<c)return{x:0,y:0};const e=(d-c)/(1-c);return{x:a*e/d,y:b*e/d}}function N(a,b){const c=Math.hypot(a,b);return c>1?{x:a/c,y:b/c}:{x:a,y:b}}function O(a){if(!a)return{x:0,y:0};let{x:b,y:c}=M(a.axes[0]||0,a.axes[1]||0,c.deadzone);const d=a.buttons[12]?.pressed?1:0,e=a.buttons[13]?.pressed?1:0,f=a.buttons[14]?.pressed?1:0,g=a.buttons[15]?.pressed?1:0;b+=g-f,c+=e-d,c.invertY&&(c*=-1);return N(b,c)}let P={x:0,y:0},Q=.95;function R(a){const b=O(a);return P.x+=(b.x-P.x)*Q,P.y+=(b.y-P.y)*Q,N(P.x,P.y)}const S=[{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0},{x:-1,y:-1}],T=S.map(a=>{const b=Math.hypot(a.x,a.y);return{x:a.x/b,y:a.y/b}}),U=Array.from({length:8},(_,a)=>document.getElementById("marker"+a));function V(a,b){const c=Math.hypot(a,b);if(c<.25)return-1;let d=-1,e=-1;return T.forEach((f,g)=>{const h=(a*f.x+b*f.y)/c;h>e&&(e=h,d=g)}),d}function W(a){T.forEach((b,c)=>{U[c].style.left=50+b.x*45+"%",U[c].style.top=50+b.y*45+"%",U[c].classList.toggle("active",c===a)})}const X=document.getElementById("stickCanvas"),Y=X.getContext("2d");let Z=0;function aa(){const a=X.getBoundingClientRect();X.width=a.width,X.height=a.height,Z=Math.min(a.width,a.height)/2-10}aa(),window.addEventListener("resize",aa);const ab=[];function ac(a,b){ab.push({x:a,y:b}),ab.length>c.trail&&ab.shift(),Y.clearRect(0,0,X.width,X.height);const d=X.width/2,e=X.height/2;for(let f=1;f<ab.length;f++){const g=ab[f-1],h=ab[f],i=f/ab.length;Y.beginPath(),Y.moveTo(d+g.x*Z,e+g.y*Z),Y.lineTo(d+h.x*Z,e+h.y*Z),Y.lineWidth=20*(i/i),Y.lineCap="round",Y.strokeStyle="rgba(200,200,200,1)",Y.shadowBlur=0,Y.shadowColor="rgba(128,128,128,1)",Y.stroke()}}function ad(a,b){H.style.left=50+a*45+"%",H.style.top=50+b*45+"%"}function loop(){const a=navigator.getGamepads()[G??0],b=R(a);ac(b.x,b.y);const{ x:c,y:d}=O(a);ad(c,d),J(a),W(V(c,d)),requestAnimationFrame(loop)}requestAnimationFrame(loop);</script></body></html>
