<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>2XKO Overlay</title><style>html,body{width:100%;height:100%;margin:0;background:transparent;display:flex;justify-content:center;align-items:center;font-family:'Swiss 721',Arial,sans-serif}#a{display:flex}#b{width:220px;height:220px;position:absolute;top:220px;left:60px;background:rgba(0,0,0,.8);border-radius:50%}#c{width:100%;height:100%;display:block;background:transparent}#d{position:absolute;width:60px;height:60px;background:rgba(215,215,215,1);border-radius:50%;border:10px solid #000;transform:translate(-50%,-50%) scale(1);pointer-events:none;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#000;font-size:30px;transition:left .01s,top .01s,transform .1s}#e{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.f{position:absolute;width:10px;height:10px;border-radius:50%;background:rgba(125,125,125,1);transform:translate(-50%,-50%);transition:all .1s}.f.active{background:rgba(255,255,255,1);width:20px;height:20px}.g{}.h{position:relative;width:300px;height:300px}.i{position:absolute;width:90px;height:90px;display:flex;align-items:center;justify-content:center;font-size:36px;text-transform:uppercase;transition:.05s;border-radius:50%;border:10px solid #000;background:rgba(180,180,180,1);box-shadow:0 2px 6px rgba(0,0,0,.25);font-family:'Swiss 721',Arial,sans-serif}.i.active{background:#fff;transform:scale(1.05)}</style></head><body><div id="a"><div id="b"><canvas id="c"></canvas><div id="e"><div class="f" id="f0"></div><div class="f" id="f1"></div><div class="f" id="f2"></div><div class="f" id="f3"></div><div class="f" id="f4"></div><div class="f" id="f5"></div><div class="f" id="f6"></div><div class="f" id="f7"></div></div><div id="d"></div></div><div class="g"><div class="h" id="j"><div class="i" data-btn="A" style="top:240px;left:280px">A</div><div class="i" data-btn="B" style="top:120px;left:280px">B</div><div class="i" data-btn="X" style="top:120px;left:40px">X</div><div class="i" data-btn="Y" style="top:120px;left:160px">Y</div><div class="i" data-btn="LB" style="top:240px;left:400px">LB</div><div class="i" data-btn="RB" style="top:120px;left:400px">RB</div><div class="i" data-btn="LT" style="top:240px;left:40px">LT</div><div class="i" data-btn="RT" style="top:240px;left:160px">RT</div><div class="i" data-btn="LS" style="top:0;left:-20px">LT</div><div class="i" data-btn="RS" style="top:0;left:460px">RT</div><div class="i" data-btn="View" style="top:0;left:100px">-</div><div class="i" data-btn="Menu" style="top:0;left:340px">+</div></div></div></div><script>const cfg={d:0.1,t:8,iY:false,map:{A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,View:8,Menu:9,LS:10,RS:11}};let gpIdx=null;window.addEventListener('gamepadconnected',e=>gpIdx=e.gamepad.index);window.addEventListener('gamepaddisconnected',()=>gpIdx=null);const btns={};document.querySelectorAll('.i').forEach(b=>btns[b.dataset.btn]=b);const joy=document.getElementById('d'),lastPress={};const ignoreBtns=new Set(['View','Menu','LS','RS']);function updBtns(pad){if(!pad?.buttons){joy.style.transform='translate(-50%,-50%) scale(1)';joy.textContent='';for(const k in btns)btns[k].classList.remove('active');return}for(const k in btns){const i=cfg.map[k];if(i===undefined)continue;const pressed=!!pad.buttons[i]?.pressed;btns[k].classList.toggle('active',pressed);pressed?lastPress[k]=performance.now():lastPress[k]=lastPress[k]||0}let actBtn=null,lt=-1;for(const k in lastPress)if(btns[k].classList.contains('active')&&!ignoreBtns.has(k)&&lastPress[k]>lt){lt=lastPress[k];actBtn=k}if(actBtn){joy.style.transform='translate(-50%,-50%) scale(1.3)';joy.textContent=btns[actBtn].textContent}else{joy.style.transform='translate(-50%,-50%) scale(1)';joy.textContent=''}}function radDZ(x,y,dz){const m=Math.hypot(x,y);if(m<dz)return{x:0,y:0};const s=(m-dz)/(1-dz);const n=s/m;return{x:x*n,y:y*n}}function clampC(x,y){const m=Math.hypot(x,y);return m>1?{x:x/m,y:y/m}:{x,y}}function getXY(pad){if(!pad)return{x:0,y:0};let {x,y}=radDZ(pad.axes[0]||0,pad.axes[1]||0,cfg.d);const up=pad.buttons[12]?.pressed?1:0,down=pad.buttons[13]?.pressed?1:0,left=pad.buttons[14]?.pressed?1:0,right=pad.buttons[15]?.pressed?1:0;x+=right-left;y+=down-up;if(cfg.iY)y*=-1;return clampC(x,y)}let smooth={x:0,y:0};const SM=.95;function getSmXY(pad){const t=getXY(pad);smooth.x+=(t.x-smooth.x)*SM;smooth.y+=(t.y-smooth.y)*SM;return clampC(smooth.x,smooth.y)}const dirs=[{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0},{x:-1,y:-1}],nDirs=dirs.map(d=>{const m=Math.hypot(d.x,d.y);return{x:d.x/m,y:d.y/m}}),marks=[];for(let i=0;i<8;i++)marks.push(document.getElementById('f'+i));function getDir(x,y){const m=Math.hypot(x,y);if(m<.25)return-1;let best=-1,bestDot=-Infinity;for(let i=0;i<nDirs.length;i++){const d=nDirs[i],dot=(x*d.x+y*d.y)/m;if(dot>bestDot){bestDot=dot;best=i}}return best}function updMarks(a){for(let i=0;i<nDirs.length;i++){const d=nDirs[i];const px=50+d.x*45,py=50+d.y*45;marks[i].style.left=px+'%';marks[i].style.top=py+'%';marks[i].classList.toggle('active',i===a)}}const can=document.getElementById('c'),ctx=can.getContext('2d');let r=0;function resize(){const rect=can.getBoundingClientRect();can.width=rect.width;can.height=rect.height;r=Math.min(rect.width,rect.height)/2-10}resize();window.addEventListener('resize',resize);const trail=[];function drawTrail(x,y){trail.push({x,y});if(trail.length>cfg.t)trail.shift();ctx.clearRect(0,0,can.width,can.height);const cx=can.width/2,cy=can.height/2;for(let i=1;i<trail.length;i++){const p0=trail[i-1],p1=trail[i],t=i/trail.length;ctx.beginPath();ctx.moveTo(cx+p0.x*r,cy+p0.y*r);ctx.lineTo(cx+p1.x*r,cy+p1.y*r);ctx.lineWidth=20*t;ctx.lineCap='round';ctx.strokeStyle='rgba(255,255,255,1)';ctx.shadowBlur=0;ctx.shadowColor='rgba(255,255,255,1)';ctx.stroke()}}function updJoy(x,y){const px=50+x*45,py=50+y*45;joy.style.left=px+'%';joy.style.top=py+'%'}function loop(){const pad=navigator.getGamepads()[gpIdx??0],sm=getSmXY(pad);drawTrail(sm.x,sm.y);const {x,y}=getXY(pad);updJoy(x,y);updBtns(pad);updMarks(getDir(x,y));requestAnimationFrame(loop)}requestAnimationFrame(loop);</script></body></html>
